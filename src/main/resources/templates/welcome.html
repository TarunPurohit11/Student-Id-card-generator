<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Welcome School</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <link rel = "stylesheet" th:href="@{/css/welcome.css}"/>
</head>
<body>
<div class="container px-3">
    <div class="card card-custom text-center">
        <h3 class="mb-3">Welcome, <span th:text="${school.schoolName}">Your School</span>!</h3>
        <p class="text-muted mb-4">Manage your students and generate ID cards with ease.</p>

        <!-- ✅ School Logo -->
        <div class="logo-wrapper">
            <img th:src="@{${#strings.replace(school.getSchoolLogoFilePath(), ' ', '%20')}}" alt="School Logo" class="img-thumbnail">
        </div>


        <!-- ✅ Upload Excel -->
        <form th:action="@{/uploadExcel/{id}(id=${school.id})}" method="post" enctype="multipart/form-data" class="mb-4 text-start">
            <div class="mb-3">
                <label for="file" class="form-label">Upload Excel (.xls / .xlsx)</label>
                <input type="file" name="excelFile" class="form-control" id="file" accept=".xls,.xlsx" required>
            </div>
            <button type="submit" class="btn btn-primary w-100">Upload Excel</button>
        </form>

        <!-- ✅ Upload Folder -->
        <form th:action="@{/uploadFolder/{id}(id=${school.id})}" method="post" enctype="multipart/form-data" class="mb-4 text-start">
            <div class="mb-3">
                <label class="form-label">Upload Folder of Images</label>
                <input type="file" name="image" webkitdirectory directory multiple class="form-control" />
            </div>
            <button type="submit" class="btn btn-secondary w-100">Upload Folder</button>
        </form>

        <!-- ✅ Generate ID Cards -->
        <a th:href="@{/generate/{id}(id=${school.id})}" class="btn btn-success w-100 mb-3">Generate Student ID Cards</a>

        <!-- ✅ Logout -->
        <a href="/loginPage" class="btn btn-link mt-3">Logout</a>
    </div>
</div>

<!-- ✅ Toast Message (Top Center) -->
<div aria-live="polite" aria-atomic="true" class="position-fixed top-0 start-50 translate-middle-x p-3" style="z-index: 1060;">
    <!-- ✅ Success Toast -->
    <div class="toast align-items-center text-white bg-success border-0"
         th:if="${success}" id="toastSuccess" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body" th:text="${success}">Success message</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
        </div>
    </div>

    <!-- ✅ Error Toast -->
    <div class="toast align-items-center text-white bg-danger border-0"
         th:if="${failed}" id="toastError" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body" th:text="${failed}">Error message</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
        </div>
    </div>
</div>

<!-- ✅ Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>

<!-- ✅ Auto-Dismiss Script -->
<script>
    window.addEventListener('DOMContentLoaded', () => {
        const success = document.getElementById('toastSuccess');
        if (success) {
            const toast = new bootstrap.Toast(success, { delay: 5000 });
            toast.show();
        }

        const error = document.getElementById('toastError');
        if (error) {
            const toast = new bootstrap.Toast(error, { delay: 5000 });
            toast.show();
        }
    });
</script>
</body>
</html>
